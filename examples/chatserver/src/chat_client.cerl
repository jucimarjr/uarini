-class(chat_client).
-author('elmiliox@gmail.com').
-constructor([register/1]).
-compile(export_all).
-static([handle_messages/1]).

class_attributes.
Nick.

class_methods.

register(Nickname) ->
    self::Nick = Nickname,
    chat_server:join(
        Nickname,
        spawn(chat_client, handle_messages, [Nickname])
    ),
    ok.

unregister() ->
    chat_server:unjoin(self::Nick).

send(Message) ->
    chat_server:send(Message).

send_to(Addressee, Message) ->
    chat_server:send_to(Addressee, Message).


handle_messages(Nickname) ->
    receive
        {printmsg, MessageBody} ->
            io:format("~p received: ~p~n", [Nickname, MessageBody]),
            handle_messages(Nickname);
        stop ->
            ok
    end.
